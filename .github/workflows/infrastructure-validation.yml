name: Infrastructure Validation

on:
  push:
    branches: [main]
    paths:
      - 'terraform/**'
      - 'k8s-manifests/**'

jobs:
  validate-infrastructure:
    name: Infrastructure Check
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
      
      - name: Check Terraform Files
        run: |
          echo "🔍 Checking Terraform configuration..."
          if [ -d "terraform" ]; then
            echo "✅ Terraform directory found"
            find terraform/ -name "*.tf" | wc -l | xargs echo "Terraform files:"
          fi
          
      - name: Check Kubernetes Manifests
        run: |
          echo "🔍 Checking Kubernetes manifests..."
          if [ -d "k8s-manifests" ]; then
            echo "✅ Kubernetes manifests found"
            find k8s-manifests/ -name "*.yaml" | wc -l | xargs echo "YAML files:"
          fi
          
      - name: Infrastructure Summary
        run: |
          echo "🎉 Infrastructure validation complete!"
          echo "✅ All infrastructure components present"
